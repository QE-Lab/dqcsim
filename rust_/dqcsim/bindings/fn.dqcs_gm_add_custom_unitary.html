<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `dqcs_gm_add_custom_unitary` fn in crate `dqcsim`."><meta name="keywords" content="rust, rustlang, rust-lang, dqcs_gm_add_custom_unitary"><title>dqcsim::bindings::dqcs_gm_add_custom_unitary - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="shortcut icon" href="../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../dqcsim/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class='location'><a href='../index.html'>dqcsim</a>::<wbr><a href='index.html'>bindings</a></p><script>window.sidebarCurrent = {name: 'dqcs_gm_add_custom_unitary', ty: 'fn', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../src/dqcsim/bindings/external/common/gm.rs.html#261-393' title='goto source code'>[src]</a></span><span class='in-band'>Function <a href='../index.html'>dqcsim</a>::<wbr><a href='index.html'>bindings</a>::<wbr><a class="fn" href=''>dqcs_gm_add_custom_unitary</a></span></h1><pre class='rust fn'><span class="docblock attributes">#[no_mangle]</span>pub extern &quot;C&quot; fn dqcs_gm_add_custom_unitary(<br>&nbsp;&nbsp;&nbsp;&nbsp;gm: <a class="type" href="../../dqcsim/bindings/type.dqcs_handle_t.html" title="type dqcsim::bindings::dqcs_handle_t">dqcs_handle_t</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_free: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>(key_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>)&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;key_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;detector: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>(user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>, matrix: <a class="type" href="../../dqcsim/bindings/type.dqcs_handle_t.html" title="type dqcsim::bindings::dqcs_handle_t">dqcs_handle_t</a>, num_controls: size_t, param_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="type" href="../../dqcsim/bindings/type.dqcs_handle_t.html" title="type dqcsim::bindings::dqcs_handle_t">dqcs_handle_t</a>) -&gt; <a class="enum" href="../../dqcsim/bindings/enum.dqcs_bool_return_t.html" title="enum dqcsim::bindings::dqcs_bool_return_t">dqcs_bool_return_t</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;detector_user_free: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>(user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>)&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;detector_user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;constructor: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>(user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*const </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>, param_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="type" href="../../dqcsim/bindings/type.dqcs_handle_t.html" title="type dqcsim::bindings::dqcs_handle_t">dqcs_handle_t</a>, num_controls: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.isize.html">isize</a>) -&gt; <a class="type" href="../../dqcsim/bindings/type.dqcs_handle_t.html" title="type dqcsim::bindings::dqcs_handle_t">dqcs_handle_t</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;constructor_user_free: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;extern &quot;C&quot; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.fn.html">fn</a>(user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a>)&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;constructor_user_data: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.pointer.html">*mut </a><a class="enum" href="https://doc.rust-lang.org/nightly/core/ffi/enum.c_void.html" title="enum core::ffi::c_void">c_void</a><br>) -&gt; <a class="enum" href="../../dqcsim/bindings/enum.dqcs_return_t.html" title="enum dqcsim::bindings::dqcs_return_t">dqcs_return_t</a></pre><div class='docblock'><p>Adds a custom unitary gate mapping to the given gate map.
&gt;</p>
<blockquote>
<p><code>gm</code> must be a handle to a gate map object (<code>dqcs_gm_new()</code>).
<code>key_free</code> is an optional callback function used to free <code>key_data</code> when
the gate map is destroyed, or when this function fails.
<code>key_data</code> is the user-specified value used to identify this mapping.
<code>detector</code> is the detector function pointer. It is optional; if null, this
mapping only supports construction.
<code>detector_user_free</code> is an optional callback function used to free
<code>detector_user_data</code> when the gate map is destroyed, when this function
fails, or when <code>detector</code> was null.
<code>detector_user_data</code> is a user-specified value that is passed to the
<code>detector</code> callback function. It is not used by DQCsim.
<code>constructor</code> is the constructor function pointer. It is optional; if
null, this mapping only supports detection.
<code>constructor_user_free</code> is an optional callback function used to free
<code>constructor_user_data</code> when the gate map is destroyed, when this function
fails, or when <code>constructor</code> was null.
<code>constructor_user_data</code> is a user-specified value that is passed to the
<code>constructor</code> callback function. It is not used by DQCsim.</p>
<p>If both <code>constructor</code> and <code>detector</code> are null for some reason, the
function is no-op (besides possibly calling the <code>*_free()</code> callbacks.</p>
<p>The detector callback receives a matrix and control qubit information for
the user to match. The matrix is passed through the <code>matrix</code> handle.
<code>num_controls</code> is passed the number of explicit control qubits that exist
besides the matrix (that is, if nonzero, the matrix is actually only the
non-controlled submatrix of the controlled gate). <code>param_data</code> is given an
<code>ArbData</code> handle initialized with the <code>ArbData</code> attached to the gate. If
the gate matches, the detector function must return <code>DQCS_TRUE</code>. In this
case, it can mutate the <code>param_data</code> to add the detected gate parameters.
If it doesn't match, it must return <code>DQCS_FALSE</code>. If an error occurs, it
must call <code>dqcs_error_set()</code> with the error message and return
<code>DQCS_BOOL_FAILURE</code>.</p>
<p>The constructor callback performs the reverse operation. It receives an
<code>ArbData</code> handle containing the parameterization data, and must construct
the matrix, return the bound on the number of control qubits, and must
return the <code>ArbData</code> associated with the gate by mutating the <code>param_data</code>
handle. <code>num_controls</code> will point to a variable initialized to -1
representing a constraint on the number of control qubits. This works as
follows: if negative, any number of qubits is allowed; if zero or
positive, only that number is allowed. If construction succeeds, the
constructor function must return a handle to the constructed matrix. If
it fails, it must call <code>dqcs_error_set()</code> with an error message and return
0.</p>
<p>It is up to the user how to do the matching and constructing, but the
converter functions must always return the same value for the same input.
In other words, they must be pure functions. Otherwise, the caching
behavior of the <code>GateMap</code> will make the results inconsistent.</p>
</blockquote>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "dqcsim";</script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>